#!/bin/bash

set -e

prompt_=""

diff_result=`git diff --staged`

res=$(afa new -script -j commit_message_suggestion -u commit_message_suggestion -p "$prompt_" <(echo "$diff_result"))

suggested_commit_messag=$(echo $res | jq -r ".suggested_commit_message")

echo "$suggested_commit_messag"
echo -n "$suggested_commit_messag" | pbcopy
